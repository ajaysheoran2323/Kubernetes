---
apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque
data:
  AWS_ACCESS_KEY_ID: dXMtZWFzdC0x
  AWS_SECRET_ACCESS_KEY: QUtJQUlLM1paNTdHVVkyUEszNUE=
  AWS_DEFAULT_REGION: bGJhSFNmU0hkODEva1BnSTFFa3FUOUF6Q2kzSlBLMFJpaEFPWTFuOA==
  
---
apiVersion: v1
kind: Pod
metadata:
  name: awscli
spec:
  containers:
  - env:
        - name: AWS_ACCESS_KEY_ID
          valueFrom:
            secretKeyRef:
              key: AWS_ACCESS_KEY_ID
              name: mysecret
              optional: false
        - name: AWS_DEFAULT_REGION
          valueFrom:
            secretKeyRef:
              key: AWS_DEFAULT_REGION
              name: mysecret
              optional: false
        - name: AWS_SECRET_ACCESS_KEY
          valueFrom:
            secretKeyRef:
              key: AWS_SECRET_ACCESS_KEY
              name: mysecret
              optional: false
    image: organs/awscli
    name: awscli
    command: ["bin/sh", "-c", "aws s3 ls"]
